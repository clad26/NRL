<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>OIST-CNRU:NRL: Neural Robotics Library (NRL)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OIST-CNRU:NRL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_README.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Neural Robotics Library (NRL) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <em>Neural Robot Library</em> (NRL) is an implementation in the C++ programming language of a neuro-cognitive control scheme for human-robot interaction experiments. The default neural network type included is a <em>Predictive-coding-inspired Variational Recurrent Neural Network</em> (PV-RNN) architecture.</p>
<h2>Project content</h2>
<p>In this repository the implementation of NRL is provided. A stand-alone demonstration program (<em><a class="el" href="main_8cpp.html">src/standalone/main.cpp</a></em>) is proposed to illustrate how to train and perform on-line inference with NRL. The sources can also be compiled as a shared library and imported to a Python version 3 programming environment. A <a href="https://youtu.be/bVgZstMjDWM" target="_blank"><b>Tutorial Video</b></a> presents the project and explains how to build and run the demonstration programs. An interesting NRL application program for real-time interaction with a virtual Cartesian robot in the Python 3 language is available in the <a href="https://github.com/oist-cnru/VCBot" target="_blank"><b>VCBot project</b></a>.</p>
<h2>Software design</h2>
<p>The software engineering project aimed at achieving three important objectives: a) to obtain real-time performance, b) to preserve the mathematical structure of neural network models as much as possible, and c) to comply with important software engineering principles, such as readability, maintainability, and extensibility. For this, the Object Oriented programming paradigm was selected for the project. The figure below shows the simplified class diagram of NRL. The full source documentation is available. After downloading the sources, you just have to open the file </p><div class="image">
<img src="documentation.html"  alt="documentation.html"/>
</div>
<p> locally in your browser.</p>
<div class="image">
<img src="classdiagram.png" alt="classdiagram.png"/>
</div>
<p>Three interfaces (abstract classes) are provided, to offer a certain level of abstraction in the source. These classes are: <em>IRobot</em>, <em>INetwork</em>, and <em>ILayer</em>. Hence, the inclusion of a new robot configuration, for instance, would require the new class inheriting and implementing the virtual methods in <em>IRobot</em>. By exploiting the property of polymorphism, minor changes should be done in other parts of the sources. An analogous principle should be applied for creating networks with diverse sorts of layers. Finally, in order to ensure computation efficiency, network and layer objects share data through context objects, which inherit from the interface <em>IContext</em>.</p>
<h2>The operation modes</h2>
<p>There are three operation modes available is NRL:</p>
<ul>
<li><p class="startli"><b>Training Mode</b></p>
<p class="startli">In this mode, the model is provided with a data-set for training. The methods in the Application Program Interface (API) related to this mode are denoted starting by the prefix <em>t_</em>. There are two ways of training: a) in background, b) interactively. When training in background (<em>LibNRL::t_background</em>), the client program waits for the whole model to be trained before regaining control in the application. For input/output efficiency, in NRL training is persisted in permanent storage each <em>min(nEpochs, nEpochs modulus 100)</em> epochs. In case of training interactively (<em>LibNRL::t_init</em>, <em>LibNRL::t_loop</em>, <em>LibNRL::t_end</em>), it is possible to regain control after each time data is saved. This is convenient for graphical user interface (GUI) based application clients, offering the possibility to cancel the training process.</p>
</li>
<li><p class="startli"><b>Experiment Mode</b></p>
<p class="startli">This mode is for real-time interaction with the robot. The related methods are denoted starting by the prefix <em>e_</em> in the API. It is required to enable the mode (<em>LibNRL::e_enable</em>) before performing experiments. Other useful methods are <em>LibNRL::e_generate</em> for behavior generation and <em>LibNRL::e_postdict</em> for on-line inference. The description of the methods signature is documented in the source files.</p>
</li>
<li><p class="startli"><b>Analysis Mode</b></p>
<p class="startli">Sometimes it is convenient to compute the output of the network from recorded states. These functionalities are performed off-line, and serve to analytical purposes. Therefore, the <em>analysis</em> methods are denoted starting by the prefix <em>a_</em> in the API.</p>
</li>
</ul>
<h2>Requirements</h2>
<p>The project has been successfully tested in the Ubuntu, OS X, and Windows operating systems.</p>
<p>It is required the <em>Eigen C++ template library for linear algebra: matrices, vectors, numerical solvers, and related algorithms</em>. The version 3.3.0 has been tested in the project. Please choose a version for download from <a href="https://gitlab.com/libeigen/eigen/-/releases">here</a></p>
<p>The <em>C++ Standard Template Library (STL)</em> is also required. Please choose the implementation of your preference. The GNU implementation has been successfully tested. For Ubuntu, this compiler is pre-installed with the distribution. For Windows it is recommended the projects <a href="http://www.mingw.org/">MinGW</a> for 32 Bits platforms, and <a href="https://www.cygwin.com/">CygWin</a> for 64 Bits platforms.</p>
<p>For building the sources it is recommended to install CMAKE. The instructions on how to install this tool in your platform are provided <a href="https://cmake.org/install/">here</a>.</p>
<h3>Compiling NRL</h3>
<p>The first step to do is providing CMAKE with the path to the parent directory containing the folder <em>Eigen</em>. For this, please change the line 54 (<em>include_directories(/PATH_TO_FOLDER_EIGEN)</em> of <em>src/standalone/CMakeLists.txt</em> (for the stand-alone program) or <em>src/lib/CMakeLists.txt</em> for compiling the shared library.</p>
<ul>
<li><p class="startli"><b>The stand alone demonstration program</b></p>
<p class="startli">Create a folder to build the sources and address the route to the folder <em>src/standalone</em> to CMAKE. For example, if the folder is to be created in the projects' root directory, you should proceed analogous to this:</p>
</li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mkdir build</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd build</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;cmake ../src/standanole</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;make</div></div><!-- fragment --><ul>
<li><p class="startli"><b>The shared library</b></p>
<p class="startli">Similar to the previous case, just change the path to the relevant <em>CMakeLists.txt</em> file</p>
</li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mkdir build</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd build</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;cmake ../src/lib</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;make</div></div><!-- fragment --><p> A wrapper class for NRL in Python version 3 is provided in 'NRL/python/NRL.py'. Thus, the same functionalities provided in the stand-alone program are available in Python 3. By default, 'NRL.py' searches for the shared library in the folder 'NRL/python/lib'. You can proceed either by creating this directory and compiling the library there, or, by editing the file 'NRL.py' and changing the path to the shared lib in the variable 'libFolder'.</p>
<h2>Instructions</h2>
<p>To run the stand-alone demo it is required to provide two arguments: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;./NRL_SA PATH_TO_PROJECT/data/properties_ROBOT.d [train|sim]</div></div><!-- fragment --><p> For running the python version of the stand-alone demo ('NRL/python/main.py'), you should proceed as follows: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python3 main.py PATH_TO_PROJECT/data/properties_ROBOT.d [train|sim]</div></div><!-- fragment --><p>There are three kind of robots available by default in NRL:</p>
<ul>
<li>Robot Cartesian (3 degrees of freedom )</li>
<li>Robot Torobo (16 degrees of freedom )</li>
<li><p class="startli">Robot Generic (28 degrees of freedom )</p>
<p class="startli">In case the configuration of these robots do not fit your project, you could create a new robot class in the <em>src/robot</em> folder. Alternatively, you could edit an existent class (for instance the <em><a class="el" href="Generic_8h.html">src/robot/Generic.h</a></em> and <em><a class="el" href="Generic_8cpp.html">src/robot/Generic.cpp</a></em>) to match the number of joints and the information on the joint limits of your project.</p>
<p class="startli">Finally, as explained below, the parameters for the neural network models are set in a dedicated properties file. Some examples are provided in the folder <em>data/config</em>.</p>
</li>
</ul>
<h3>Demonstration</h3>
<p>A dummy dataset is provided to analyze the computational performance in your system. The dataset is composed of sequences of 100 time steps with random floating point data. The primitives in <em>data/dataset</em> are available in the human-readable file format <em>comma-separated value</em> (CSV). The naming convention followed is <em>primitive_ID_SAMPLING.csv</em>. Here <em>ID</em> is an integer identification number assigned to the primitive, and <em>SAMPLING</em> is an integer denoting the number of samples available for the primitive. In total, three primitives conform the dataset (<em>ID</em>=0: 1 sample, <em>ID</em>=1: 3 samples, <em>ID</em>=2: 2 samples).</p>
<h3>Results</h3>
<p>The following results were obtained running the stand-alone program. The host platform was a computer Alienware Aurora R7, 12 Intel® CoreTM i7-8700K CPU at 3.70GHz, and 32 GiB RAM memory, running in Ubuntu 16.04 LTS. When running the version built as a shared library and included in Python 3, the performance is estimated to drop around 30%.</p>
<ul>
<li><p class="startli"><b>The robot Cartesian</b></p>
<p class="startli"><em>Training</em> </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Training from scratch ...</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Epoch [100] - Time [23487.6ms] - RE_Q [335.409] - RE_P [653.864] - Regulation [39.4366] - loss [119.69]</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Model saved!</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Epoch [200] - Time [23476ms] - RE_Q [308.124] - RE_P [371.773] - Regulation [21.2025] - loss [106.949]</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Model saved!</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Epoch [300] - Time [23503.5ms] - RE_Q [304.847] - RE_P [308.088] - Regulation [12.4978] - loss [104.115]</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Model saved!</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Epoch [400] - Time [23452.8ms] - RE_Q [295.217] - RE_P [317.019] - Regulation [8.40558] - loss [100.087]</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Model saved!</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Epoch [500] - Time [23461.4ms] - RE_Q [302.422] - RE_P [294.137] - Regulation [5.31455] - loss [101.87]</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Epoch [600] - Time [23455.1ms] - RE_Q [294.582] - RE_P [314.82] - Regulation [4.38003] - loss [99.0701]</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;Model saved!</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;Epoch [700] - Time [23456ms] - RE_Q [288.958] - RE_P [293.106] - Regulation [3.92122] - loss [97.1034]</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;Model saved!</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;Epoch [800] - Time [23514.9ms] - RE_Q [303.388] - RE_P [288.831] - Regulation [4.38013] - loss [102.005]</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;Epoch [900] - Time [23526.6ms] - RE_Q [288.442] - RE_P [293.512] - Regulation [3.33614] - loss [96.8146]</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;Model saved!</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;Epoch [1000] - Time [23661.8ms] - RE_Q [289.363] - RE_P [287.358] - Regulation [2.90963] - loss [97.0364]</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;Training end</div></div><!-- fragment --><p> <em>Simulation</em> </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;simulation demonstration begin</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Model loaded!</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Step: 1 in 43.1785 ms</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Step: 2 in 43.2941 ms</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Step: 3 in 43.0191 ms</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Step: 4 in 42.9615 ms</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Step: 5 in 43.2043 ms</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Step: 6 in 43.0813 ms</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Step: 7 in 42.9529 ms</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Step: 8 in 43.2127 ms</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Step: 9 in 43.0466 ms</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;Step: 10 in 43.0158 ms</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;Step: 11 in 43.24 ms</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;Step: 12 in 42.967 ms</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;Step: 13 in 42.986 ms</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;Step: 14 in 43.2415 ms</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;Step: 15 in 42.996 ms</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;simulation demonstration end</div></div><!-- fragment --></li>
<li><p class="startli"><b>The robot Torobo</b></p>
<p class="startli"><em>Training</em> </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Training from scratch ...</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Epoch [100] - Time [55993.1ms] - RE_Q [1188.61] - RE_P [3420.26] - Regulation [49.8778] - loss [84.2634]</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Model saved!</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Epoch [200] - Time [55829.3ms] - RE_Q [948.287] - RE_P [1551.03] - Regulation [29.44] - loss [65.1559]</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Model saved!</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Epoch [300] - Time [55950.4ms] - RE_Q [879.619] - RE_P [824.855] - Regulation [21.3711] - loss [59.2504]</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Model saved!</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Epoch [400] - Time [55894.8ms] - RE_Q [799.868] - RE_P [1551.69] - Regulation [12.2354] - loss [52.4389]</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Model saved!</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Epoch [500] - Time [55822.1ms] - RE_Q [852.259] - RE_P [787.73] - Regulation [9.52194] - loss [55.1706]</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Epoch [600] - Time [55900.4ms] - RE_Q [785.516] - RE_P [1027.18] - Regulation [6.89619] - loss [50.474]</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;Model saved!</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;Epoch [700] - Time [55840.3ms] - RE_Q [714.994] - RE_P [772.807] - Regulation [5.43834] - loss [45.7748]</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;Model saved!</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;Epoch [800] - Time [55585.8ms] - RE_Q [934.616] - RE_P [721.111] - Regulation [7.83391] - loss [59.9803]</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;Epoch [900] - Time [55570ms] - RE_Q [712.984] - RE_P [823.665] - Regulation [4.65715] - loss [45.4929]</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;Model saved!</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;Epoch [1000] - Time [55929.5ms] - RE_Q [735.673] - RE_P [762.851] - Regulation [4.19637] - loss [46.8189]</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;Training end</div></div><!-- fragment --><p> <em>Simulation</em> </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;simulation demonstration begin</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Model loaded!</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Step: 1 in 93.0724 ms</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Step: 2 in 91.6953 ms</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Step: 3 in 91.4821 ms</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Step: 4 in 91.3739 ms</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Step: 5 in 91.3501 ms</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Step: 6 in 90.0752 ms</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Step: 7 in 90.2209 ms</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Step: 8 in 90.3339 ms</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Step: 9 in 90.9228 ms</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;Step: 10 in 91.0096 ms</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;Step: 11 in 90.8634 ms</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;Step: 12 in 90.0855 ms</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;Step: 13 in 90.6236 ms</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;Step: 14 in 90.3553 ms</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;Step: 15 in 90.2141 ms</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;simulation demonstration end</div></div><!-- fragment --></li>
<li><p class="startli"><b>The robot Generic</b></p>
<p class="startli"><em>Training</em> </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Training from scratch ...</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Epoch [100] - Time [86071.6ms] - RE_Q [1817.14] - RE_P [6922.24] - Regulation [31.7749] - loss [71.2527]</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Model saved!</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Epoch [200] - Time [85936.5ms] - RE_Q [1222.26] - RE_P [2633.2] - Regulation [20.5835] - loss [47.7688]</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Model saved!</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Epoch [300] - Time [85904.5ms] - RE_Q [1246.48] - RE_P [1147.18] - Regulation [12.1075] - loss [46.9388]</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Model saved!</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Epoch [400] - Time [85831.3ms] - RE_Q [1098.29] - RE_P [1140.75] - Regulation [4.81528] - loss [40.1878]</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Model saved!</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Epoch [500] - Time [85906ms] - RE_Q [1132.96] - RE_P [1084.95] - Regulation [4.67464] - loss [41.3977]</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Epoch [600] - Time [86025.3ms] - RE_Q [1059.51] - RE_P [1249.31] - Regulation [3.55755] - loss [38.5511]</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;Model saved!</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;Epoch [700] - Time [86144.7ms] - RE_Q [1023.01] - RE_P [1046.9] - Regulation [3.29288] - loss [37.1945]</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;Model saved!</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;Epoch [800] - Time [85945.3ms] - RE_Q [1150.83] - RE_P [1012.85] - Regulation [3.54976] - loss [41.8111]</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;Epoch [900] - Time [85829.8ms] - RE_Q [1023.06] - RE_P [1096.09] - Regulation [3.23186] - loss [37.1844]</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;Model saved!</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;Epoch [1000] - Time [85667.2ms] - RE_Q [1035.68] - RE_P [1001.85] - Regulation [2.6702] - loss [37.5226]</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;Training end</div></div><!-- fragment --><p> <em>Simulation</em> </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;simulation demonstration begin</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Model loaded!</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Step: 1 in 134.842 ms</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Step: 2 in 134.769 ms</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Step: 3 in 134.787 ms</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Step: 4 in 134.858 ms</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Step: 5 in 134.903 ms</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Step: 6 in 134.898 ms</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Step: 7 in 134.867 ms</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Step: 8 in 134.838 ms</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Step: 9 in 134.846 ms</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;Step: 10 in 134.804 ms</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;Step: 11 in 134.819 ms</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;Step: 12 in 134.899 ms</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;Step: 13 in 134.856 ms</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;Step: 14 in 134.909 ms</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;Step: 15 in 134.937 ms</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;simulation demonstration end</div></div><!-- fragment --></li>
</ul>
<p>NRL loads a configuration file specifying the parameters of the model. Some of these parameters ensure the operation of NRL, others are specific to the network architecture contained in the library (e.g. the parameters <em>w</em>, <em>d</em>, <em>z</em>, and <em>t</em> are specific to the neural network type PV-RNN). The <em>delimiter</em> char for separating multiple fields is the comma (','). The fields described next are separated from values by the character '='.</p>
<table class="doxtable">
<tr>
<th>Parameter</th><th>Description  </th></tr>
<tr>
<td>datapath </td><td>Full path to the data-set </td></tr>
<tr>
<td>modelpath</td><td>Full path to the model </td></tr>
<tr>
<td>robot</td><td>The robot name (e.g ‘cartesian’,’torobo’, ‘generic’) </td></tr>
<tr>
<td>activejoints</td><td>A <em>delimiter</em> separated integer 1 (active) or 0 (Inactive), indicating the joint's activation (e.g. '1,1,0' the first two out of three joints are activated) </td></tr>
<tr>
<td>nsamples</td><td>Integer number of samples per primitive separated by <em>delimiter</em> (e.g. '1,1,1' for three primitives with one sample each) </td></tr>
<tr>
<td>w</td><td>PV-RNN: Real numbers for meta parameters <em>w</em> per layer for training the model (e.g '0.025,0.025' for a two-layered network) </td></tr>
<tr>
<td>d</td><td>PV-RNN: Integer number of <em>d</em> units per layer for training the model (e.g. '40,10' indicating 40 units in layer one and 10 units in layer two) </td></tr>
<tr>
<td>z</td><td>PV-RNN: Integer number of <em>z</em> units per layer for training the model (e.g. '4,1' indicating 4 units in layer one and 1 units in layer two) </td></tr>
<tr>
<td>t</td><td>PV-RNN: Integer time constants per layer for training the model (e.g. '2,10' indicating 2 time steps for layer one and 10 time steps for layer two) </td></tr>
<tr>
<td>epochs</td><td>Integer number of training epochs (e.g. '50000') </td></tr>
<tr>
<td>alpha</td><td>Adam optimization parameter &alpha; for training the model (e.g. '0.001') </td></tr>
<tr>
<td>beta1</td><td>Adam optimization parameter &beta;<sub>1</sub> for training the model (e.g. '0.9') </td></tr>
<tr>
<td>beta2</td><td>Adam optimization parameter &beta;<sub>2</sub> for training the model (e.g. '0.999') </td></tr>
<tr>
<td>shuffle</td><td>Boolean flag indicating to shuffle the training order of the primitives in the dataset (e.g. 'true' or 'false') </td></tr>
<tr>
<td>retrain</td><td>Boolean flag indicating the intention to retrain the model, or overwrite previous training (e.g. 'true' or 'false') </td></tr>
<tr>
<td>greedy</td><td>Boolean flag indicating the intention to save the model only if optimal loss function value was obtained (e.g. 'true' or 'false') </td></tr>
<tr>
<td>dsoft</td><td>Real number indicating the distance between reference values in the joint space encoded by the softmax function (e.g. '10' would indicate a neuron for each 10 units in the joint space) </td></tr>
<tr>
<td>sigma</td><td>Real number for the sigma parameter in the softmax function (e.g. '0.2') </td></tr>
</table>
<h2>Variable naming convention</h2>
<p>In the table below it is presented the variable naming convention adopted in order to improve the readability of the sources.</p>
<table class="doxtable">
<tr>
<th>Token</th><th>Description  </th></tr>
<tr>
<td>t</td><td>training mode </td></tr>
<tr>
<td>e</td><td>experiment mode </td></tr>
<tr>
<td>c</td><td>context </td></tr>
<tr>
<td>g</td><td>gradient </td></tr>
<tr>
<td>m</td><td>mean (first moment, ADAM optimization) </td></tr>
<tr>
<td>v</td><td>uncentered variance (second moment, ADAM optimization) </td></tr>
<tr>
<td>W</td><td>synaptic weight matrix (e.g 'Wdh' means synaptic weights from the latent state 'd' to the latent state 'h') </td></tr>
<tr>
<td>B</td><td>bias </td></tr>
<tr>
<td>p</td><td>prior distribution </td></tr>
<tr>
<td>q</td><td>posterior distribution </td></tr>
<tr>
<td>d</td><td>latent state d </td></tr>
<tr>
<td>h</td><td>latent state h </td></tr>
<tr>
<td>n</td><td>noise </td></tr>
<tr>
<td>z</td><td>latent state z </td></tr>
<tr>
<td>u</td><td>latent state mu </td></tr>
<tr>
<td>s</td><td>latent state sigma </td></tr>
<tr>
<td>l</td><td>latent state log sigma </td></tr>
<tr>
<td>w</td><td>meta-parameter w </td></tr>
<tr>
<td>i</td><td>iterator </td></tr>
<tr>
<td>au</td><td>parameter a mu </td></tr>
<tr>
<td>al</td><td>parameter a log sigma </td></tr>
<tr>
<td>ut</td><td>utils </td></tr>
<tr>
<td>id</td><td>identity </td></tr>
<tr>
<td>bw</td><td>backward computation </td></tr>
<tr>
<td>kld</td><td>Kullback-Leibler divergence </td></tr>
<tr>
<td>bottom</td><td>bottom level </td></tr>
<tr>
<td>top</td><td>top level </td></tr>
<tr>
<td>gen</td><td>variable associated with the generation process </td></tr>
<tr>
<td>opt</td><td>optimal </td></tr>
<tr>
<td>cur</td><td>current </td></tr>
<tr>
<td>dim</td><td>dimension </td></tr>
<tr>
<td>num</td><td>number </td></tr>
<tr>
<td>sum</td><td>summation </td></tr>
<tr>
<td>sub</td><td>subtraction </td></tr>
<tr>
<td>div</td><td>division </td></tr>
<tr>
<td>mul</td><td>multiplication </td></tr>
<tr>
<td>pow</td><td>power </td></tr>
<tr>
<td>len</td><td>length </td></tr>
<tr>
<td>tau</td><td>Greek letter tau </td></tr>
<tr>
<td>eps</td><td>Greek letter epsilon </td></tr>
<tr>
<td>rec</td><td>reconstruction component of the loss function </td></tr>
<tr>
<td>reg</td><td>regulation component of the loss function </td></tr>
<tr>
<td>coef</td><td>coefficient </td></tr>
<tr>
<td>prim</td><td>primitive </td></tr>
<tr>
<td>loss</td><td>loss function </td></tr>
<tr>
<td>next</td><td>time t = t + 1 </td></tr>
<tr>
<td>prev</td><td>time t = t - 1 </td></tr>
<tr>
<td>tanh</td><td>hyperbolic tangent </td></tr>
<tr>
<td>tzero</td><td>time t = 0 </td></tr>
<tr>
<td>thres</td><td>threshold </td></tr>
<tr>
<td>transpose</td><td>transpose of a vector or matrix </td></tr>
</table>
<h2>Work reference</h2>
<p>H. F. Chame, A. Ahmadi, J. Jun (2020) <em>Towards hybrid primary intersubjectivity: a neural robotics library for human science</em></p>
<h2>Contact</h2>
<p>This program was implemented by: Hendry F. Chame</p>
<p><b>Lab</b> Cognitive Neurorobotics Research Unit (CNRU)</p>
<p><b>Institution</b> Okinawa Institute of Science and Technology Graduate University (OIST)</p>
<p><b>Address</b> 1919-1, Tancha, Onna, Kunigami District, Okinawa 904-0495, Japan</p>
<p><b>E-mail</b> <a href="#" onclick="location.href='mai'+'lto:'+'hen'+'dr'+'yfc'+'ha'+'me@'+'gm'+'ail'+'.c'+'om'; return false;">hendr<span style="display: none;">.nosp@m.</span>yfch<span style="display: none;">.nosp@m.</span>ame@g<span style="display: none;">.nosp@m.</span>mail<span style="display: none;">.nosp@m.</span>.com</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
